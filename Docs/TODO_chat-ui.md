# 📦 chat-ui 模块开发 TODO

> **模块职责**：基于 ChatUI 的前端聊天界面，提供用户对话体验和客服状态控制

## 🎯 MVP 核心任务（第 2 周）

### 🔥 P0 - 基础聊天界面

- [ ] **项目初始化**

  - [ ] 创建 `chat-ui/` 目录结构
  - [ ] 初始化 React 项目 (Vite + React 18)
  - [ ] 安装依赖 `@chatui/core`, `axios`, `ws`
  - [ ] 配置 Vite 开发环境和代理

- [ ] **核心聊天组件**

  - [ ] 集成 ChatUI 聊天组件
  - [ ] 实现消息气泡展示 (用户/AI/系统消息)
  - [ ] 实现消息输入框和发送功能
  - [ ] 添加消息时间戳显示
  - [ ] 实现消息列表自动滚动

- [ ] **WebSocket 客户端**
  - [ ] 实现 WebSocket 连接管理
  - [ ] 实现消息发送和接收
  - [ ] 添加连接状态指示器
  - [ ] 实现断线重连机制

### 🟡 P1 - 状态控制功能

- [ ] **接待者状态显示**

  - [ ] 显示当前接待者 (AI/人工客服)
  - [ ] 实现状态切换按钮 ("转人工"/"AI 接管")
  - [ ] 添加状态变更提示消息
  - [ ] 实现接管状态的视觉区分

- [ ] **用户体验优化**
  - [ ] 添加消息发送状态 (发送中/已送达)
  - [ ] 实现输入防抖和节流
  - [ ] 添加快捷键支持 (Enter 发送)
  - [ ] 实现消息类型标识 (AI/人工标签)

### 🔥 P0 - 基础交互功能

- [ ] **消息处理**

  - [ ] 实现消息格式化和展示
  - [ ] 支持文本消息的发送和接收
  - [ ] 添加系统消息展示 (欢迎语、状态变更)
  - [ ] 实现消息历史加载

- [ ] **错误处理**
  - [ ] 网络错误提示和重试
  - [ ] WebSocket 连接异常处理
  - [ ] 消息发送失败处理
  - [ ] 添加全局错误边界

## 🚀 扩展功能（后续版本）

### 🟢 P2 - 高级功能

- [ ] **满意度反馈**

  - [ ] 添加满意度评分按钮 (👍 👎)
  - [ ] 实现反馈提交功能
  - [ ] 显示反馈结果提示

- [ ] **快捷功能**

  - [ ] 实现快捷指令菜单
  - [ ] 添加常见问题快速回复
  - [ ] 支持消息模板功能

- [ ] **界面优化**
  - [ ] 实现主题切换 (明/暗模式)
  - [ ] 添加消息搜索功能
  - [ ] 实现聊天记录导出

## 📁 目录结构

```
chat-ui/
├── src/
│   ├── components/
│   │   ├── Chat/
│   │   │   ├── ChatContainer.jsx
│   │   │   ├── MessageList.jsx
│   │   │   ├── MessageInput.jsx
│   │   │   └── StatusBar.jsx
│   │   ├── Common/
│   │   │   ├── Loading.jsx
│   │   │   └── ErrorBoundary.jsx
│   │   └── index.js
│   ├── hooks/
│   │   ├── useWebSocket.js
│   │   ├── useChat.js
│   │   └── index.js
│   ├── services/
│   │   ├── api.js
│   │   ├── websocket.js
│   │   └── index.js
│   ├── utils/
│   │   ├── constants.js
│   │   ├── helpers.js
│   │   └── index.js
│   ├── styles/
│   │   └── chat.css
│   ├── App.jsx
│   └── main.jsx
├── public/
├── tests/
│   ├── components/
│   └── hooks/
├── package.json
└── vite.config.js
```

## 🔧 技术要求

- **框架**: React 18 + Vite
- **UI 库**: ChatUI (@chatui/core)
- **状态管理**: React Hooks (useState, useEffect, useContext)
- **HTTP 客户端**: axios
- **WebSocket**: 原生 WebSocket API
- **测试框架**: Vitest + React Testing Library
- **样式**: CSS Modules / Styled Components

## 📋 验收标准

- [ ] 聊天界面美观且响应式设计
- [ ] WebSocket 连接稳定，消息收发正常
- [ ] 支持 AI/人工状态切换功能
- [ ] 具备完整的错误处理和用户提示
- [ ] 消息历史正确加载和显示
- [ ] 通过所有组件测试

## 🔗 依赖关系

- **依赖**: `chat-core` 模块 (WebSocket + REST API)
- **被依赖**: 无 (前端入口应用)
- **外部服务**: chat-core 服务

## 🎨 UI/UX 设计要求

1. **消息气泡设计**

   - 用户消息：右侧蓝色气泡
   - AI 消息：左侧灰色气泡，带 AI 标识
   - 人工消息：左侧绿色气泡，带客服标识
   - 系统消息：居中显示，浅色背景

2. **状态指示器**

   - 连接状态：绿色(已连接)/红色(断开)/黄色(连接中)
   - 接待者状态：明显的 AI/人工标识
   - 消息状态：发送中/已送达图标

3. **交互体验**
   - 平滑的消息动画效果
   - 清晰的按钮反馈
   - 合理的加载状态提示

## 🚨 关键注意事项

1. **性能优化**: 大量消息时的虚拟滚动
2. **移动端适配**: 响应式设计，触摸友好
3. **无障碍支持**: 键盘导航，屏幕阅读器支持
4. **安全考虑**: XSS 防护，消息内容过滤
